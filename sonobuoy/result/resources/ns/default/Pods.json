[{"metadata":{"name":"clusterapi-tester","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/clusterapi-tester","uid":"b390bab3-e672-11e9-a1c5-c400ad16bc2d","resourceVersion":"26938914","creationTimestamp":"2019-10-04T06:46:32Z","deletionTimestamp":"2019-10-04T06:52:03Z","deletionGracePeriodSeconds":30},"spec":{"volumes":[{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"containers":[{"name":"clusterapi-tester","image":"gcr.io/kubernetes-e2e-test-images/clusterapi-tester-amd64:1.0","resources":{},"volumeMounts":[{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"readinessProbe":{"httpGet":{"path":"/healthz","port":8080,"scheme":"HTTP"},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":3},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"OnFailure","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-04T06:46:32Z"},{"type":"Ready","status":"False","lastProbeTime":null,"lastTransitionTime":"2019-10-04T06:46:32Z","reason":"ContainersNotReady","message":"containers with unready status: [clusterapi-tester]"},{"type":"ContainersReady","status":"False","lastProbeTime":null,"lastTransitionTime":null,"reason":"ContainersNotReady","message":"containers with unready status: [clusterapi-tester]"},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-04T06:46:32Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.141","startTime":"2019-10-04T06:46:32Z","containerStatuses":[{"name":"clusterapi-tester","state":{"terminated":{"exitCode":0,"startedAt":null,"finishedAt":null}},"lastState":{"terminated":{"exitCode":1,"reason":"Error","startedAt":"2019-10-04T06:49:55Z","finishedAt":"2019-10-04T06:49:55Z","containerID":"docker://4ad2ff1274c32170d3c187da7e5796e749586a8daf5c35f0b4954c356b0faf7e"}},"ready":false,"restartCount":5,"image":"gcr.io/kubernetes-e2e-test-images/clusterapi-tester-amd64:1.0","imageID":"docker-pullable://gcr.io/kubernetes-e2e-test-images/clusterapi-tester-amd64@sha256:edb18172f1e985662a1f5138a8a76750abde4eb02dfea808112c9cc0bcc84d9a","containerID":"docker://4ad2ff1274c32170d3c187da7e5796e749586a8daf5c35f0b4954c356b0faf7e"}],"qosClass":"BestEffort"}},{"metadata":{"name":"es-deviceon-portal-6886d46868-7hnrc","generateName":"es-deviceon-portal-6886d46868-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-deviceon-portal-6886d46868-7hnrc","uid":"c17998ba-e4e5-11e9-a1c5-c400ad16bc2d","resourceVersion":"26489570","creationTimestamp":"2019-10-02T07:25:05Z","labels":{"app":"es-deviceon","deviceonModule":"deviceon-portal","pod-template-hash":"2442802424","release":"es-deviceon"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-deviceon-portal-6886d46868","uid":"c15117f4-e4e5-11e9-a1c5-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config","configMap":{"name":"es-deviceon","items":[{"key":"serverConfig","path":"Server_Config.xml"}],"defaultMode":420}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"initContainers":[{"name":"init","image":"adveiss.azurecr.io/es-postgres:9.6.11","command":["sh"],"args":["-c","set -x\n\necho \"Waiting for PostgreSQL to be initialized...\"\nuntil psql -c 'select * from public.device' \u0026\u003e /dev/null; do\n    echo \"Still initializing...\"\n    sleep 2\ndone\n"],"env":[{"name":"PGHOST","value":"es-postgres"},{"name":"PGPORT","value":"5432"},{"name":"PGDATABASE","value":"wisepaas"},{"name":"PGUSER","value":"deviceon"},{"name":"PGPASSWORD","value":"deviceon"}],"resources":{},"volumeMounts":[{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"containers":[{"name":"es-deviceon-portal","image":"adveiss.azurecr.io/es-deviceon-portal:1.1.32","env":[{"name":"SERVER_ACTIVATENAME","value":"DeviceOn_Data-Server"},{"name":"SERVER_CONFIG","value":"/deviceon/config"},{"name":"CATALINA_OPTS","value":"-Xmx768M -Xms768M -XX:MetaspaceSize=256M -XX:MaxMetaspaceSize=256M"}],"resources":{"limits":{"memory":"2Gi"},"requests":{"memory":"2Gi"}},"volumeMounts":[{"name":"config","readOnly":true,"mountPath":"/deviceon/config"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:25:11Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:31:45Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:25:05Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.190","startTime":"2019-10-02T07:25:05Z","initContainerStatuses":[{"name":"init","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T07:25:10Z","finishedAt":"2019-10-02T07:25:10Z","containerID":"docker://99817e3db78980a04eebbdd10797fa8ba1fbce5ff3dafdda72c239a3c98e55d9"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-postgres:9.6.11","imageID":"docker-pullable://adveiss.azurecr.io/es-postgres@sha256:e75c6bcfb815ae42a14faf7b2e6b94c0decc13dcf1a61ae242ac4eef0298b278","containerID":"docker://99817e3db78980a04eebbdd10797fa8ba1fbce5ff3dafdda72c239a3c98e55d9"}],"containerStatuses":[{"name":"es-deviceon-portal","state":{"running":{"startedAt":"2019-10-02T07:31:43Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-deviceon-portal:1.1.32","imageID":"docker-pullable://adveiss.azurecr.io/es-deviceon-portal@sha256:c058e0cf26e0f3b318ed6b3177d00eae320dc96644cf9f5955f9808200faa26f","containerID":"docker://993c336b0d5a78841da5bb90b5ab627d9c0fb66ff288dd7c638061494c2b3d57"}],"qosClass":"Burstable"}},{"metadata":{"name":"es-deviceon-provisioning-6f5d74c9df-2vqzm","generateName":"es-deviceon-provisioning-6f5d74c9df-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-deviceon-provisioning-6f5d74c9df-2vqzm","uid":"c1852de0-e4e5-11e9-a1c5-c400ad16bc2d","resourceVersion":"26489012","creationTimestamp":"2019-10-02T07:25:05Z","labels":{"app":"es-deviceon","deviceonModule":"provisioning-worker","pod-template-hash":"2918307589","release":"es-deviceon"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-deviceon-provisioning-6f5d74c9df","uid":"c1510d1f-e4e5-11e9-a1c5-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config","configMap":{"name":"es-deviceon","items":[{"key":"serverConfig","path":"Server_Config.xml"}],"defaultMode":420}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"initContainers":[{"name":"init","image":"adveiss.azurecr.io/es-postgres:9.6.11","command":["sh"],"args":["-c","set -x\n\necho \"Waiting for PostgreSQL to be initialized...\"\nuntil psql -c 'select * from public.device' \u0026\u003e /dev/null; do\n    echo \"Still initializing...\"\n    sleep 2\ndone\n"],"env":[{"name":"PGHOST","value":"es-postgres"},{"name":"PGPORT","value":"5432"},{"name":"PGDATABASE","value":"wisepaas"},{"name":"PGUSER","value":"deviceon"},{"name":"PGPASSWORD","value":"deviceon"}],"resources":{},"volumeMounts":[{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"containers":[{"name":"es-deviceon-provisioning","image":"adveiss.azurecr.io/es-provisioning-worker:1.1.32","env":[{"name":"SERVER_CONFIG","value":"/deviceon/config"},{"name":"JAVA_OPTS","value":"-Xmx210665K -Xms210665K -XX:MetaspaceSize=64M -XX:MaxMetaspaceSize=64M -Xss228K"}],"resources":{"limits":{"memory":"512Mi"},"requests":{"memory":"512Mi"}},"volumeMounts":[{"name":"config","readOnly":true,"mountPath":"/deviceon/config"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:25:13Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:28:18Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:25:05Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.173","startTime":"2019-10-02T07:25:06Z","initContainerStatuses":[{"name":"init","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T07:25:12Z","finishedAt":"2019-10-02T07:25:12Z","containerID":"docker://4caec0c149339b1a861dc98340dee0e093293734b52a07311e7381c9af5033d0"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-postgres:9.6.11","imageID":"docker-pullable://adveiss.azurecr.io/es-postgres@sha256:e75c6bcfb815ae42a14faf7b2e6b94c0decc13dcf1a61ae242ac4eef0298b278","containerID":"docker://4caec0c149339b1a861dc98340dee0e093293734b52a07311e7381c9af5033d0"}],"containerStatuses":[{"name":"es-deviceon-provisioning","state":{"running":{"startedAt":"2019-10-02T07:28:16Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-provisioning-worker:1.1.32","imageID":"docker-pullable://adveiss.azurecr.io/es-provisioning-worker@sha256:f98f23289e4dd06f429915501effde31a3885d6bbd07431e9374b854b0c21b85","containerID":"docker://c99cd9e509c79898abd5e0ff849717513a225749d88d42690685906e25b17e2d"}],"qosClass":"Burstable"}},{"metadata":{"name":"es-deviceon-worker-78f8585bcd-q55nn","generateName":"es-deviceon-worker-78f8585bcd-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-deviceon-worker-78f8585bcd-q55nn","uid":"c1852768-e4e5-11e9-a1c5-c400ad16bc2d","resourceVersion":"26489091","creationTimestamp":"2019-10-02T07:25:05Z","labels":{"app":"es-deviceon","deviceonModule":"deviceon-worker","pod-template-hash":"3494141678","release":"es-deviceon"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-deviceon-worker-78f8585bcd","uid":"c150d916-e4e5-11e9-a1c5-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config","configMap":{"name":"es-deviceon","items":[{"key":"serverConfig","path":"Server_Config.xml"}],"defaultMode":420}},{"name":"script","configMap":{"name":"es-deviceon","items":[{"key":"initPostgres","path":"postgres.sql"},{"key":"initMongo","path":"mongo.js"}],"defaultMode":420}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"initContainers":[{"name":"init-postgres","image":"adveiss.azurecr.io/es-postgres:9.6.11","command":["sh"],"args":["-c","set -x\n\necho \"Waiting for PostgreSQL to be ready...\"\nuntil pg_isready -q; do\n    echo \"Still waiting...\"\n    sleep 2\ndone\n\necho \"Initializing PostgreSQL roles...\"\npsql -f /deviceon/init/postgres.sql\npsql -c \"SELECT 'x123' FROM pg_database WHERE datname='wisepaas'\" | grep 'x123'\nif [ $? -ne 0 ]; then\n    echo \"Creating 'wisepaas' database...\"\n    psql -c \"CREATE DATABASE wisepaas WITH OWNER wisepaas\"\nfi\n"],"env":[{"name":"PGHOST","value":"es-postgres"},{"name":"PGPORT","value":"5432"},{"name":"PGUSER","value":"postgres"},{"name":"PGPASSWORD","value":"advant1cH"}],"resources":{},"volumeMounts":[{"name":"script","readOnly":true,"mountPath":"/deviceon/init"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"},{"name":"init-mongo","image":"adveiss.azurecr.io/es-mongo:3.6.9-stretch","command":["bash"],"args":["-c","set -x\n\nIFS=';' read -ra M_HOST \u003c\u003c\u003c \"es-mongo\"\nIFS=';' read -ra M_PORT \u003c\u003c\u003c \"27017\"\n\nHOST=\"\"\nif [ ${#M_HOST[@]} -eq ${#M_PORT[@]} ]; then\n    end=${#M_HOST[@]}\n    for ((i = 0; i \u003c end; i++)); do\n        if [ \"${HOST}\" = \"\" ]; then\n            HOST=\"${M_HOST[i]}:${M_PORT[i]}\"\n        else\n            HOST=\"${HOST},${M_HOST[i]}:${M_PORT[i]}\"\n        fi\n    done\nfi\n\nif $(echo ${HOST} | grep -q ','); then\n    HOST=\"mongodb://${HOST}/?replicaSet=rs0\"\nfi\n\necho \"Waiting for MongoDB to be ready...\"\nuntil mongo --host ${HOST} -u \"admin\" -p \"advant1cH\" --eval \"db.adminCommand('ping')\" admin; do\n    echo \"Still waiting...\"\n    sleep 2\ndone\n\necho \"Initializing MongoDB...\"\nmongo --host ${HOST} -u \"admin\" -p \"advant1cH\" admin /deviceon/init/mongo.js\n"],"resources":{},"volumeMounts":[{"name":"script","readOnly":true,"mountPath":"/deviceon/init"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"containers":[{"name":"es-deviceon-worker","image":"adveiss.azurecr.io/es-deviceon-worker:1.1.32","env":[{"name":"SERVER_ACTIVATENAME","value":"DeviceOn_Data-Server"},{"name":"SERVER_CONFIG","value":"/deviceon/config"},{"name":"JAVA_OPTS","value":"-Xmx384M -Xms384M -XX:MetaspaceSize=64M -XX:MaxMetaspaceSize=64M -Xss228K -XX:-UseGCOverheadLimit -XX:+CMSClassUnloadingEnabled -XX:+UseConcMarkSweepGC"}],"resources":{"limits":{"memory":"1Gi"},"requests":{"memory":"1Gi"}},"volumeMounts":[{"name":"config","readOnly":true,"mountPath":"/deviceon/config"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:25:18Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:28:49Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:25:05Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.140","startTime":"2019-10-02T07:25:06Z","initContainerStatuses":[{"name":"init-postgres","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T07:25:11Z","finishedAt":"2019-10-02T07:25:11Z","containerID":"docker://2b00b6c9596ec48004a44a37b7d6937068db38461a4ebe7a46d25909bc00ecf0"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-postgres:9.6.11","imageID":"docker-pullable://adveiss.azurecr.io/es-postgres@sha256:e75c6bcfb815ae42a14faf7b2e6b94c0decc13dcf1a61ae242ac4eef0298b278","containerID":"docker://2b00b6c9596ec48004a44a37b7d6937068db38461a4ebe7a46d25909bc00ecf0"},{"name":"init-mongo","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T07:25:16Z","finishedAt":"2019-10-02T07:25:17Z","containerID":"docker://8d45490b16ede774a757a70f9671b6a510368609f31a7cccab4e51058fd20e93"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-mongo:3.6.9-stretch","imageID":"docker-pullable://adveiss.azurecr.io/es-mongo@sha256:18d69e38a0beb6f8c6694c4508f931280d92dec0a82f729d162d121fbd2109ae","containerID":"docker://8d45490b16ede774a757a70f9671b6a510368609f31a7cccab4e51058fd20e93"}],"containerStatuses":[{"name":"es-deviceon-worker","state":{"running":{"startedAt":"2019-10-02T07:28:47Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-deviceon-worker:1.1.32","imageID":"docker-pullable://adveiss.azurecr.io/es-deviceon-worker@sha256:ae66e08f9f0bbc04f275c7af01bc613d9d8d2004bf029095c5dad2bc2479ab19","containerID":"docker://03c2a39ed4b615eed1dfcfff4279c1f79aaee0add3a30e294beecf4af54c246f"}],"qosClass":"Burstable"}},{"metadata":{"name":"es-edgesense-ota-966c7fb68-f9442","generateName":"es-edgesense-ota-966c7fb68-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-edgesense-ota-966c7fb68-f9442","uid":"a56395fa-e4e8-11e9-a1c5-c400ad16bc2d","resourceVersion":"26491877","creationTimestamp":"2019-10-02T07:45:46Z","labels":{"app":"es-edgesense","pod-template-hash":"522739624","release":"es-edgesense","rmmModule":"ota-worker"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-edgesense-ota-966c7fb68","uid":"a5164321-e4e8-11e9-a1c5-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config","configMap":{"name":"es-edgesense","items":[{"key":"serverConfig","path":"Server_Config.xml"}],"defaultMode":420}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"initContainers":[{"name":"init","image":"adveiss.azurecr.io/es-postgres:9.6.11","command":["sh"],"args":["-c","set -x\n\necho \"Waiting for PostgreSQL to be initialized...\"\nuntil psql -c 'select * from public.device' \u0026\u003e /dev/null; do\n    echo \"Still initializing...\"\n    sleep 2\ndone\n"],"env":[{"name":"PGHOST","value":"es-postgres"},{"name":"PGPORT","value":"5432"},{"name":"PGDATABASE","value":"wisepaas"},{"name":"PGUSER","value":"rmm"},{"name":"PGPASSWORD","value":"rmm"}],"resources":{},"volumeMounts":[{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"containers":[{"name":"es-edgesense-ota","image":"adveiss.azurecr.io/es-ota-worker:1.0.104","env":[{"name":"SERVER_CONFIG","value":"/rmm/config"},{"name":"JAVA_OPTS","value":"-Xmx210665K -Xms210665K -XX:MetaspaceSize=64M -XX:MaxMetaspaceSize=64M -Xss228K"}],"resources":{"limits":{"memory":"512Mi"},"requests":{"memory":"512Mi"}},"volumeMounts":[{"name":"config","readOnly":true,"mountPath":"/rmm/config"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:45:55Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:45:57Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:45:47Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.186","startTime":"2019-10-02T07:45:47Z","initContainerStatuses":[{"name":"init","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T07:45:53Z","finishedAt":"2019-10-02T07:45:53Z","containerID":"docker://fcf8e5bf5a9a6bc9d91e275d99e94cb1ff6bc2ceaa55869e39a5e2cbab65ea38"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-postgres:9.6.11","imageID":"docker-pullable://adveiss.azurecr.io/es-postgres@sha256:e75c6bcfb815ae42a14faf7b2e6b94c0decc13dcf1a61ae242ac4eef0298b278","containerID":"docker://fcf8e5bf5a9a6bc9d91e275d99e94cb1ff6bc2ceaa55869e39a5e2cbab65ea38"}],"containerStatuses":[{"name":"es-edgesense-ota","state":{"running":{"startedAt":"2019-10-02T07:45:57Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-ota-worker:1.0.104","imageID":"docker-pullable://adveiss.azurecr.io/es-ota-worker@sha256:ea80e2a7e33cf1708c1e65a79afb957e567222bd61d01d30b84567bdb965468f","containerID":"docker://ba76bffc0619579f57da4094a11ce488fbee66e83cac880f2b6ab710e0b6ac56"}],"qosClass":"Burstable"}},{"metadata":{"name":"es-edgesense-portal-76f5b54966-x2pfx","generateName":"es-edgesense-portal-76f5b54966-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-edgesense-portal-76f5b54966-x2pfx","uid":"a5635728-e4e8-11e9-a1c5-c400ad16bc2d","resourceVersion":"26491875","creationTimestamp":"2019-10-02T07:45:46Z","labels":{"app":"es-edgesense","pod-template-hash":"3291610522","release":"es-edgesense","rmmModule":"rmm-portal"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-edgesense-portal-76f5b54966","uid":"a5163827-e4e8-11e9-a1c5-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config","configMap":{"name":"es-edgesense","items":[{"key":"serverConfig","path":"Server_Config.xml"}],"defaultMode":420}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"initContainers":[{"name":"init","image":"adveiss.azurecr.io/es-postgres:9.6.11","command":["sh"],"args":["-c","set -x\n\necho \"Waiting for PostgreSQL to be initialized...\"\nuntil psql -c 'select * from public.device' \u0026\u003e /dev/null; do\n    echo \"Still initializing...\"\n    sleep 2\ndone\n"],"env":[{"name":"PGHOST","value":"es-postgres"},{"name":"PGPORT","value":"5432"},{"name":"PGDATABASE","value":"wisepaas"},{"name":"PGUSER","value":"rmm"},{"name":"PGPASSWORD","value":"rmm"}],"resources":{},"volumeMounts":[{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"containers":[{"name":"es-edgesense-portal","image":"adveiss.azurecr.io/es-rmm-portal:1.0.104","env":[{"name":"SERVER_ACTIVATENAME","value":"EdgeSense_Data-Server"},{"name":"SERVER_CONFIG","value":"/rmm/config"},{"name":"CATALINA_OPTS","value":"-Xmx768M -Xms768M -XX:MetaspaceSize=256M -XX:MaxMetaspaceSize=256M"}],"resources":{"limits":{"memory":"2Gi"},"requests":{"memory":"2Gi"}},"volumeMounts":[{"name":"config","readOnly":true,"mountPath":"/rmm/config"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:45:54Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:45:57Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:45:46Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.130","startTime":"2019-10-02T07:45:47Z","initContainerStatuses":[{"name":"init","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T07:45:52Z","finishedAt":"2019-10-02T07:45:52Z","containerID":"docker://2783136cef7a73b40e4ee9b11157d03b2dfda55df9a58b7ca29de249b0c22da4"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-postgres:9.6.11","imageID":"docker-pullable://adveiss.azurecr.io/es-postgres@sha256:e75c6bcfb815ae42a14faf7b2e6b94c0decc13dcf1a61ae242ac4eef0298b278","containerID":"docker://2783136cef7a73b40e4ee9b11157d03b2dfda55df9a58b7ca29de249b0c22da4"}],"containerStatuses":[{"name":"es-edgesense-portal","state":{"running":{"startedAt":"2019-10-02T07:45:55Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-rmm-portal:1.0.104","imageID":"docker-pullable://adveiss.azurecr.io/es-rmm-portal@sha256:98533a971893728d71ff04ac46dbfe5664d5f6adbc41a7ab04e90e672d8cd184","containerID":"docker://31e846d9c1dbff85bdabc847f9fa74a5be8de98b8424e6ed5279639701505ce7"}],"qosClass":"Burstable"}},{"metadata":{"name":"es-edgesense-worker-5b6f55fc8d-56b8t","generateName":"es-edgesense-worker-5b6f55fc8d-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-edgesense-worker-5b6f55fc8d-56b8t","uid":"a5635ac0-e4e8-11e9-a1c5-c400ad16bc2d","resourceVersion":"26491896","creationTimestamp":"2019-10-02T07:45:46Z","labels":{"app":"es-edgesense","pod-template-hash":"1629119748","release":"es-edgesense","rmmModule":"rmm-worker"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-edgesense-worker-5b6f55fc8d","uid":"a5296d3e-e4e8-11e9-a1c5-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"config","configMap":{"name":"es-edgesense","items":[{"key":"serverConfig","path":"Server_Config.xml"}],"defaultMode":420}},{"name":"script","configMap":{"name":"es-edgesense","items":[{"key":"initPostgres","path":"postgres.sql"},{"key":"initMongo","path":"mongo.js"}],"defaultMode":420}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"initContainers":[{"name":"init-postgres","image":"adveiss.azurecr.io/es-postgres:9.6.11","command":["sh"],"args":["-c","set -x\n\necho \"Waiting for PostgreSQL to be ready...\"\nuntil pg_isready -q; do\n    echo \"Still waiting...\"\n    sleep 2\ndone\n\necho \"Initializing PostgreSQL roles...\"\npsql -f /rmm/init/postgres.sql\npsql -c \"SELECT 'x123' FROM pg_database WHERE datname='wisepaas'\" | grep 'x123'\nif [ $? -ne 0 ]; then\n    echo \"Creating 'wisepaas' database...\"\n    psql -c \"CREATE DATABASE wisepaas WITH OWNER wisepaas\"\nfi\n"],"env":[{"name":"PGHOST","value":"es-postgres"},{"name":"PGPORT","value":"5432"},{"name":"PGUSER","value":"postgres"},{"name":"PGPASSWORD","value":"advant1cH"}],"resources":{},"volumeMounts":[{"name":"script","readOnly":true,"mountPath":"/rmm/init"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"},{"name":"init-mongo","image":"adveiss.azurecr.io/es-mongo:3.6.9-stretch","command":["bash"],"args":["-c","set -x\n\nIFS=';' read -ra M_HOST \u003c\u003c\u003c \"es-mongo\"\nIFS=';' read -ra M_PORT \u003c\u003c\u003c \"27017\"\n\nHOST=\"\"\nif [ ${#M_HOST[@]} -eq ${#M_PORT[@]} ]; then\n    end=${#M_HOST[@]}\n    for ((i = 0; i \u003c end; i++)); do\n        if [ \"${HOST}\" = \"\" ]; then\n            HOST=\"${M_HOST[i]}:${M_PORT[i]}\"\n        else\n            HOST=\"${HOST},${M_HOST[i]}:${M_PORT[i]}\"\n        fi\n    done\nfi\n\nif $(echo ${HOST} | grep -q ','); then\n    HOST=\"mongodb://${HOST}/?replicaSet=rs0\"\nfi\n\necho \"Waiting for MongoDB to be ready...\"\nuntil mongo --host ${HOST} -u \"admin\" -p \"advant1cH\" --eval \"db.adminCommand('ping')\" admin; do\n    echo \"Still waiting...\"\n    sleep 2\ndone\n\necho \"Initializing MongoDB...\"\nmongo --host ${HOST} -u \"admin\" -p \"advant1cH\" admin /rmm/init/mongo.js\n"],"resources":{},"volumeMounts":[{"name":"script","readOnly":true,"mountPath":"/rmm/init"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"containers":[{"name":"es-edgesense-worker","image":"adveiss.azurecr.io/es-rmm-worker:1.0.104","env":[{"name":"SERVER_ACTIVATENAME","value":"EdgeSense_Data-Server"},{"name":"SERVER_CONFIG","value":"/rmm/config"},{"name":"JAVA_OPTS","value":"-Xmx384M -Xms384M -XX:MetaspaceSize=64M -XX:MaxMetaspaceSize=64M -Xss228K -XX:-UseGCOverheadLimit -XX:+CMSClassUnloadingEnabled -XX:+UseConcMarkSweepGC"}],"resources":{"limits":{"memory":"1Gi"},"requests":{"memory":"1Gi"}},"volumeMounts":[{"name":"config","readOnly":true,"mountPath":"/rmm/config"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:45:58Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:46:01Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T07:45:47Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.152","startTime":"2019-10-02T07:45:47Z","initContainerStatuses":[{"name":"init-postgres","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T07:45:53Z","finishedAt":"2019-10-02T07:45:53Z","containerID":"docker://181ae0db72abc3541f2b100aedc3bd37a18ac9965b9175ad044291e15af9ae38"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-postgres:9.6.11","imageID":"docker-pullable://adveiss.azurecr.io/es-postgres@sha256:e75c6bcfb815ae42a14faf7b2e6b94c0decc13dcf1a61ae242ac4eef0298b278","containerID":"docker://181ae0db72abc3541f2b100aedc3bd37a18ac9965b9175ad044291e15af9ae38"},{"name":"init-mongo","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T07:45:57Z","finishedAt":"2019-10-02T07:45:57Z","containerID":"docker://d0aeba80a8bf75f10c8f03f54a1abc40b5550196a1452d69f1f8be8baf93cb9d"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-mongo:3.6.9-stretch","imageID":"docker-pullable://adveiss.azurecr.io/es-mongo@sha256:18d69e38a0beb6f8c6694c4508f931280d92dec0a82f729d162d121fbd2109ae","containerID":"docker://d0aeba80a8bf75f10c8f03f54a1abc40b5550196a1452d69f1f8be8baf93cb9d"}],"containerStatuses":[{"name":"es-edgesense-worker","state":{"running":{"startedAt":"2019-10-02T07:46:00Z"}},"lastState":{},"ready":true,"restartCount":0,"image":"adveiss.azurecr.io/es-rmm-worker:1.0.104","imageID":"docker-pullable://adveiss.azurecr.io/es-rmm-worker@sha256:cf7a39f509da0d224c5eaa0b53c490359e88fca7999ad59fbae7c4263916117d","containerID":"docker://38b33bc874ab2f1e2e3330cafdfd753cc793d135ba8278bcf05d0c935c1d6bd0"}],"qosClass":"Burstable"}},{"metadata":{"name":"es-minio-68fb8556cf-chg6g","generateName":"es-minio-68fb8556cf-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-minio-68fb8556cf-chg6g","uid":"f58a764c-e104-11e9-b1b9-c400ad16bc2d","resourceVersion":"26452388","creationTimestamp":"2019-09-27T08:58:22Z","labels":{"app":"es-minio","pod-template-hash":"2496411279","release":"es-minio"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-minio-68fb8556cf","uid":"111a997e-e103-11e9-b1b9-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"export","persistentVolumeClaim":{"claimName":"es-minio"}},{"name":"minio-server-config","configMap":{"name":"es-minio","defaultMode":420}},{"name":"minio-user","secret":{"secretName":"es-minio","defaultMode":420}},{"name":"minio-config-dir","emptyDir":{}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"containers":[{"name":"es-minio","image":"adveiss.azurecr.io/minio:RELEASE.2018-12-06T01-27-43Z","command":["/bin/sh","-ce","cp /tmp/config.json /root/.minio/ \u0026\u0026 /usr/bin/docker-entrypoint.sh minio -C /root/.minio/ server /export"],"ports":[{"name":"service","containerPort":9000,"protocol":"TCP"}],"env":[{"name":"MINIO_ACCESS_KEY","valueFrom":{"secretKeyRef":{"name":"es-minio","key":"accesskey"}}},{"name":"MINIO_SECRET_KEY","valueFrom":{"secretKeyRef":{"name":"es-minio","key":"secretkey"}}},{"name":"MINIO_BROWSER","value":"on"}],"resources":{"limits":{"cpu":"250m","memory":"512Mi"},"requests":{"cpu":"250m","memory":"512Mi"}},"volumeMounts":[{"name":"export","mountPath":"/export"},{"name":"minio-server-config","mountPath":"/tmp/config.json","subPath":"config.json"},{"name":"minio-config-dir","mountPath":"/root/.minio/"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"livenessProbe":{"httpGet":{"path":"/minio/health/live","port":"service","scheme":"HTTP"},"initialDelaySeconds":5,"timeoutSeconds":1,"periodSeconds":30,"successThreshold":1,"failureThreshold":3},"readinessProbe":{"httpGet":{"path":"/minio/health/ready","port":"service","scheme":"HTTP"},"timeoutSeconds":1,"periodSeconds":15,"successThreshold":1,"failureThreshold":3},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-09-27T08:58:22Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T03:38:39Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-09-27T08:58:22Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.181","startTime":"2019-09-27T08:58:22Z","containerStatuses":[{"name":"es-minio","state":{"running":{"startedAt":"2019-10-02T03:38:14Z"}},"lastState":{"terminated":{"exitCode":137,"reason":"Error","startedAt":"2019-09-27T08:58:31Z","finishedAt":"2019-10-02T03:35:27Z","containerID":"docker://6711ea65264c9461aae22457ead4047ce27e31c366208d1077ce0fb39ebabd05"}},"ready":true,"restartCount":1,"image":"adveiss.azurecr.io/minio:RELEASE.2018-12-06T01-27-43Z","imageID":"docker-pullable://adveiss.azurecr.io/minio@sha256:35e29a6dd047d8987b80b9b8168ed04ce1c85456551438e685f8a7abbbb5783e","containerID":"docker://6ec102110d5ea82073d5aae0fef1d4db6ae7f547de5268e2a763e945e21b3677"}],"qosClass":"Guaranteed"}},{"metadata":{"name":"es-mongo-7477b4bcf-5gtwr","generateName":"es-mongo-7477b4bcf-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-mongo-7477b4bcf-5gtwr","uid":"88ebf460-c247-11e9-90d6-c400ad16bc2d","resourceVersion":"26452414","creationTimestamp":"2019-08-19T06:06:50Z","labels":{"app":"es-mongo","chart":"es-mongo-1.0.8","component":"mongo-database","pod-template-hash":"303360679","release":"es-mongo"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-mongo-7477b4bcf","uid":"88cd277c-c247-11e9-90d6-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"es-mongo"}},{"name":"conf","configMap":{"name":"es-mongo","items":[{"key":"mongod.conf","path":"mongod.conf"}],"defaultMode":420}},{"name":"etc","emptyDir":{}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"initContainers":[{"name":"init","image":"adveiss.azurecr.io/es-mongo:3.6.9-stretch","command":["bash"],"args":["-c","set -x\nbytes_total=$(cat /sys/fs/cgroup/memory/memory.limit_in_bytes)\nbytes_cache=$(( (bytes_total - 1024**3) / 2 ))\nmin_bytes_cache=$(( 256 * 1024**2 ))\n[ ${bytes_cache} -lt ${min_bytes_cache} ] \\\n    \u0026\u0026 bytes_cache=${min_bytes_cache}\n\ngb_cache=$(printf %.1f\\\\n \"$(( bytes_cache * 10**3 / 1024**3 ))e-3\")\ncat \u003c\u003c EOF \u003e /etc/mongo/mongod.conf\nstorage:\n  wiredTiger:\n    engineConfig:\n      cacheSizeGB: ${gb_cache}\nEOF\ncat /tmp/conf/mongod.conf \u003e\u003e /etc/mongo/mongod.conf\n"],"resources":{"limits":{"memory":"6Gi"},"requests":{"memory":"6Gi"}},"volumeMounts":[{"name":"conf","mountPath":"/tmp/conf"},{"name":"etc","mountPath":"/etc/mongo"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"containers":[{"name":"es-mongo","image":"adveiss.azurecr.io/es-mongo:3.6.9-stretch","args":["--config=/etc/mongo/mongod.conf"],"ports":[{"name":"mongo-database","containerPort":27017,"protocol":"TCP"}],"env":[{"name":"MONGO_INITDB_ROOT_USERNAME","valueFrom":{"secretKeyRef":{"name":"es-mongo","key":"mongo-username"}}},{"name":"MONGO_INITDB_ROOT_PASSWORD","valueFrom":{"secretKeyRef":{"name":"es-mongo","key":"mongo-password"}}}],"resources":{"limits":{"memory":"6Gi"},"requests":{"memory":"6Gi"}},"volumeMounts":[{"name":"data","mountPath":"/data/db"},{"name":"etc","mountPath":"/etc/mongo"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"livenessProbe":{"exec":{"command":["bash","-c","exec mongo --username=${MONGO_INITDB_ROOT_USERNAME} --password=${MONGO_INITDB_ROOT_PASSWORD} --authenticationDatabase=admin --eval=\"db.adminCommand('ping')\""]},"initialDelaySeconds":30,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":6},"readinessProbe":{"exec":{"command":["bash","-c","exec mongo --username=${MONGO_INITDB_ROOT_USERNAME} --password=${MONGO_INITDB_ROOT_PASSWORD} --authenticationDatabase=admin --eval=\"db.adminCommand('ping')\""]},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":6},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-09-17T06:23:48Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T03:38:41Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-08-19T06:06:50Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.147","startTime":"2019-08-19T06:06:51Z","initContainerStatuses":[{"name":"init","state":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-10-02T03:37:59Z","finishedAt":"2019-10-02T03:37:59Z","containerID":"docker://69ffa71a8704e3c4d6bb336b0d75257fefbe379e534ef29be8555a7563663ee8"}},"lastState":{},"ready":true,"restartCount":3,"image":"adveiss.azurecr.io/es-mongo:3.6.9-stretch","imageID":"docker-pullable://adveiss.azurecr.io/es-mongo@sha256:18d69e38a0beb6f8c6694c4508f931280d92dec0a82f729d162d121fbd2109ae","containerID":"docker://69ffa71a8704e3c4d6bb336b0d75257fefbe379e534ef29be8555a7563663ee8"}],"containerStatuses":[{"name":"es-mongo","state":{"running":{"startedAt":"2019-10-02T03:38:25Z"}},"lastState":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-09-17T06:23:53Z","finishedAt":"2019-10-02T03:35:24Z","containerID":"docker://f7260200e0abe125512551be402e0e41b19ed900de2f2c6bcc8663a702f5f003"}},"ready":true,"restartCount":3,"image":"adveiss.azurecr.io/es-mongo:3.6.9-stretch","imageID":"docker-pullable://adveiss.azurecr.io/es-mongo@sha256:18d69e38a0beb6f8c6694c4508f931280d92dec0a82f729d162d121fbd2109ae","containerID":"docker://05d0db53b09856f87fe81de3054e4ce42491123d043850be65800dd0283b885f"}],"qosClass":"Burstable"}},{"metadata":{"name":"es-postgres-d9448cc8c-qrx45","generateName":"es-postgres-d9448cc8c-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-postgres-d9448cc8c-qrx45","uid":"3dc19822-ce11-11e9-89b8-c400ad16bc2d","resourceVersion":"26452397","creationTimestamp":"2019-09-03T06:08:25Z","labels":{"app":"es-postgres","chart":"es-postgres-1.0.7","pod-template-hash":"850047747","release":"es-postgres"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-postgres-d9448cc8c","uid":"3d8d2208-ce11-11e9-89b8-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"es-postgres"}},{"name":"etc","secret":{"secretName":"es-postgres","items":[{"key":"username","path":"username"},{"key":"password","path":"password"}],"defaultMode":420}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"containers":[{"name":"es-postgres","image":"adveiss.azurecr.io/es-postgres:9.6.11","ports":[{"name":"postgres","containerPort":5432,"protocol":"TCP"}],"env":[{"name":"POSTGRES_USER_FILE","value":"/etc/postgresql/username"},{"name":"POSTGRES_PASSWORD_FILE","value":"/etc/postgresql/password"},{"name":"PGDATA","value":"/var/lib/postgresql/data/pgdata"},{"name":"POD_IP","valueFrom":{"fieldRef":{"apiVersion":"v1","fieldPath":"status.podIP"}}}],"resources":{"limits":{"memory":"512Mi"},"requests":{"memory":"512Mi"}},"volumeMounts":[{"name":"data","mountPath":"/var/lib/postgresql/data"},{"name":"etc","mountPath":"/etc/postgresql"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"livenessProbe":{"exec":{"command":["sh","-c","exec pg_isready -U \"postgres\" --host ${POD_IP}"]},"initialDelaySeconds":30,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":6},"readinessProbe":{"exec":{"command":["sh","-c","exec pg_isready -U \"postgres\" --host ${POD_IP}"]},"initialDelaySeconds":10,"timeoutSeconds":5,"periodSeconds":10,"successThreshold":1,"failureThreshold":6},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-09-03T06:08:25Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T03:38:35Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-09-03T06:08:25Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.176","startTime":"2019-09-03T06:08:25Z","containerStatuses":[{"name":"es-postgres","state":{"running":{"startedAt":"2019-10-02T03:38:15Z"}},"lastState":{"terminated":{"exitCode":137,"reason":"Error","startedAt":"2019-09-17T06:24:44Z","finishedAt":"2019-10-02T03:35:28Z","containerID":"docker://ba6d90e0a335310a545e1f78598b2626bd63362d303d1d5906ba94ce5e6f5950"}},"ready":true,"restartCount":2,"image":"adveiss.azurecr.io/es-postgres:9.6.11","imageID":"docker-pullable://adveiss.azurecr.io/es-postgres@sha256:e75c6bcfb815ae42a14faf7b2e6b94c0decc13dcf1a61ae242ac4eef0298b278","containerID":"docker://466aec0c195e712c6f3bd1062c7415df6fe755a7b04958ed6ccf90eff00ceab4"}],"qosClass":"Burstable"}},{"metadata":{"name":"es-rabbitmq-68b84c55d5-9pph5","generateName":"es-rabbitmq-68b84c55d5-","namespace":"default","selfLink":"/api/v1/namespaces/default/pods/es-rabbitmq-68b84c55d5-9pph5","uid":"1d79844d-cfbd-11e9-89b8-c400ad16bc2d","resourceVersion":"26452651","creationTimestamp":"2019-09-05T09:11:16Z","labels":{"app":"es-rabbitmq","chart":"es-rabbitmq-1.0.9","pod-template-hash":"2464071181","release":"es-rabbitmq"},"ownerReferences":[{"apiVersion":"apps/v1","kind":"ReplicaSet","name":"es-rabbitmq-68b84c55d5","uid":"1d61ec89-cfbd-11e9-89b8-c400ad16bc2d","controller":true,"blockOwnerDeletion":true}]},"spec":{"volumes":[{"name":"data","persistentVolumeClaim":{"claimName":"es-rabbitmq"}},{"name":"etc","configMap":{"name":"es-rabbitmq","items":[{"key":"enabled_plugins","path":"enabled_plugins"},{"key":"rabbitmq.conf","path":"rabbitmq.conf"},{"key":"set_env.sh","path":"set_env.sh"}],"defaultMode":420}},{"name":"ssl","secret":{"secretName":"es-rabbitmq","items":[{"key":"cacert.pem","path":"cacert.pem"},{"key":"cert.pem","path":"cert.pem"},{"key":"key.pem","path":"key.pem"}],"defaultMode":420}},{"name":"default-token-c5979","secret":{"secretName":"default-token-c5979","defaultMode":420}}],"containers":[{"name":"es-rabbitmq","image":"adveiss.azurecr.io/es-rabbitmq:3.7.8","ports":[{"name":"epmd","containerPort":4369,"protocol":"TCP"},{"name":"amqp","containerPort":5672,"protocol":"TCP"},{"name":"mqtt","containerPort":1883,"protocol":"TCP"},{"name":"http","containerPort":15672,"protocol":"TCP"},{"name":"amqp-ssl","containerPort":5671,"protocol":"TCP"},{"name":"mqtt-ssl","containerPort":8883,"protocol":"TCP"}],"env":[{"name":"RABBITMQ_ERLANG_COOKIE","valueFrom":{"secretKeyRef":{"name":"es-rabbitmq","key":"rabbitmq-erlang-cookie"}}}],"resources":{"limits":{"memory":"6Gi"},"requests":{"memory":"6Gi"}},"volumeMounts":[{"name":"data","mountPath":"/var/lib/rabbitmq"},{"name":"etc","mountPath":"/etc/rabbitmq"},{"name":"ssl","readOnly":true,"mountPath":"/ssl"},{"name":"default-token-c5979","readOnly":true,"mountPath":"/var/run/secrets/kubernetes.io/serviceaccount"}],"livenessProbe":{"httpGet":{"path":"/api/healthchecks/node","port":15672,"scheme":"HTTP","httpHeaders":[{"name":"Authorization","value":"Basic YWRtaW46YWR2YW50MWNI"}]},"initialDelaySeconds":120,"timeoutSeconds":15,"periodSeconds":15,"successThreshold":1,"failureThreshold":6},"readinessProbe":{"httpGet":{"path":"/api/healthchecks/node","port":15672,"scheme":"HTTP","httpHeaders":[{"name":"Authorization","value":"Basic YWRtaW46YWR2YW50MWNI"}]},"initialDelaySeconds":30,"timeoutSeconds":15,"periodSeconds":15,"successThreshold":1,"failureThreshold":6},"lifecycle":{"postStart":{"exec":{"command":["sh","/etc/rabbitmq/set_env.sh"]}}},"terminationMessagePath":"/dev/termination-log","terminationMessagePolicy":"File","imagePullPolicy":"IfNotPresent"}],"restartPolicy":"Always","terminationGracePeriodSeconds":30,"dnsPolicy":"ClusterFirst","serviceAccountName":"default","serviceAccount":"default","nodeName":"k8s-m1","securityContext":{},"imagePullSecrets":[{"name":"acr-auth"}],"schedulerName":"default-scheduler","tolerations":[{"key":"node.kubernetes.io/not-ready","operator":"Exists","effect":"NoExecute","tolerationSeconds":300},{"key":"node.kubernetes.io/unreachable","operator":"Exists","effect":"NoExecute","tolerationSeconds":300}],"priority":0},"status":{"phase":"Running","conditions":[{"type":"Initialized","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-09-05T09:11:16Z"},{"type":"Ready","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-10-02T03:38:21Z"},{"type":"ContainersReady","status":"True","lastProbeTime":null,"lastTransitionTime":null},{"type":"PodScheduled","status":"True","lastProbeTime":null,"lastTransitionTime":"2019-09-05T09:11:16Z"}],"hostIP":"192.168.11.6","podIP":"10.233.106.156","startTime":"2019-09-05T09:11:16Z","containerStatuses":[{"name":"es-rabbitmq","state":{"running":{"startedAt":"2019-10-02T03:37:48Z"}},"lastState":{"terminated":{"exitCode":0,"reason":"Completed","startedAt":"2019-09-17T06:23:11Z","finishedAt":"2019-10-02T03:35:22Z","containerID":"docker://bdb10c8e0ad05f40499e473b2e98c54d9109580bfa61497f8dbe4e8d6f0d0311"}},"ready":true,"restartCount":2,"image":"adveiss.azurecr.io/es-rabbitmq:3.7.8","imageID":"docker-pullable://adveiss.azurecr.io/es-rabbitmq@sha256:a87320ccf6315a58218a251063e277d6219f91ddd78e37d8e10cd8d452843c2c","containerID":"docker://c9f67cc75d5720a5efeda3dfb5d052862e02cf7064117526e425a509873efe37"}],"qosClass":"Burstable"}}]