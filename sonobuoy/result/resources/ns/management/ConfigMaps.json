[{"metadata":{"name":"kubeapps-frontend-config","namespace":"management","selfLink":"/api/v1/namespaces/management/configmaps/kubeapps-frontend-config","uid":"befe2439-e668-11e9-a1c5-c400ad16bc2d","resourceVersion":"26926799","creationTimestamp":"2019-10-04T05:35:16Z","labels":{"app":"kubeapps-frontend-config","chart":"kubeapps-2.0.3","heritage":"Tiller","release":"kubeapps"}},"data":{"vhost.conf":"# Retain the default nginx handling of requests without a \"Connection\" header\nmap $http_upgrade $connection_upgrade {\n  default upgrade;\n  ''      close;\n}\n\n# Allow websocket connections\nproxy_set_header Upgrade    $http_upgrade;\nproxy_set_header Connection $connection_upgrade;\n\nserver {\n  listen 8080;\n  server_name _;\n\n  location /healthz {\n    access_log off;\n    default_type text/plain;\n    return 200 \"healthy\\n\";\n  }\n\n  # Using regexp match instead of prefix one because the application can be\n  # deployed under a specific path i.e /kubeapps\n  location ~* /api/kube {\n    rewrite /api/kube/(.*) /$1 break;\n    rewrite /api/kube / break;\n    proxy_pass https://kubernetes.default;\n    # Disable buffering for log streaming\n    proxy_buffering off;\n    # Hide Www-Authenticate to prevent it triggering a basic auth prompt in\n    # the browser with some clusters\n    proxy_hide_header Www-Authenticate;\n\n    # Keep the connection open with the API server even if idle (the default is 60 seconds)\n    # Setting it to 1 hour which should be enough for our current use case of deploying/upgrading apps\n    # If we enable other use-cases in the future we might need to bump this value\n    # More info here https://github.com/kubeapps/kubeapps/issues/766\n    proxy_read_timeout 1h;\n  }\n\n  location ~* /api/chartsvc {\n    rewrite /api/chartsvc/(.*) /$1 break;\n    rewrite /api/chartsvc / break;\n    proxy_pass http://kubeapps-internal-chartsvc:8080;\n  }\n\n  location ~* /api/tiller-deploy {\n    # Keep the connection open with the API server even if idle (the default is 60 seconds)\n    # Setting it to 10 minutes which should be enough for our current use case of deploying/upgrading/deleting apps\n    proxy_read_timeout 10m;\n    rewrite /api/tiller-deploy/(.*) /$1 break;\n    rewrite /api/tiller-deploy / break;\n    proxy_pass http://kubeapps-internal-tiller-proxy:8080;\n  }\n\n  location / {\n    # Add the Authorization header if exists\n    add_header Authorization $http_authorization;\n\n    proxy_pass http://kubeapps-internal-dashboard:8080;\n  }\n}"}},{"metadata":{"name":"kubeapps-internal-dashboard-config","namespace":"management","selfLink":"/api/v1/namespaces/management/configmaps/kubeapps-internal-dashboard-config","uid":"befde70f-e668-11e9-a1c5-c400ad16bc2d","resourceVersion":"26926798","creationTimestamp":"2019-10-04T05:35:16Z","labels":{"app":"kubeapps-internal-dashboard-config","chart":"kubeapps-2.0.3","heritage":"Tiller","release":"kubeapps"}},"data":{"config.json":"{\n  \"namespace\": \"management\",\n  \"appVersion\": \"DEVEL\"\n}","vhost.conf":"server {\n  listen 8080;\n  server_name _;\n\n  gzip on;\n  gzip_static  on;\n\n  location / {\n    # Redirects are required to be relative otherwise the internal hostname will be exposed\n    absolute_redirect off;\n\n    # Trailing / is required in the path for the React app to be loaded correctly\n    # The rewrite rule adds a trailing \"/\" to any path that does not contain \".\" neither \"/\".\n    # i.e kubeapps =\u003e kubeapps/\n    rewrite ^([^.]*[^/])$ $1/ permanent;\n\n    # Support for ingress prefixes maintaining compatibility with the default /\n    # 1 - Exactly two fragment URLs for files existing inside of the public/ dir\n    # i.e /[prefix]/config.json =\u003e /config.json\n    rewrite ^/[^/]+/([^/]+)$ /$1 break;\n\n    # 2 - Any static files bundled by webpack referenced by 3 or more URL segments\n    # i.e /[prefix]/static/main.js =\u003e static/main.js\n    rewrite ^/[^/]+/static/(.*) /static/$1 break;\n\n    try_files $uri /index.html;\n  }\n}"}}]